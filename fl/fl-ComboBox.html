<!--
    Copyright (c) 2017
    @author:        Sean Denny
    @description:   Fluent Design Custom Elements by SD
    @license:       MIT
    @source:        https://github.com/Nektro/custom-elements/tree/master/fl
-->
<!--
    https://docs.microsoft.com/en-us/windows/uwp/controls-and-patterns/lists#drop-down-lists
-->
<style>
    fl-combobox {
        display: block;
        margin: 1em 0px;
    }
</style>
<template id="template-fl-combobox">
    <style>
        :host select {
            width: 100%;
            height: 30px;
            border: 2px solid #cfcfcf;
            outline: none;
            display: block;
            margin-top: 10px;
        }
        :host select:hover {
            border: 2px solid #7f7f7f;
        }
        :host select:disabled {
            background-color: #dadada;
            border: 2px solid #dadada;
        }
        :host select option {
            background-color: #dadada;
        }
    </style>
    <label></label>
    <select>
        <slot name="options"></slot>
    </select>
</template>
<script>
    (function() {
        const doc = document.currentScript.ownerDocument;
        customElements.define('fl-combobox', class FLComboBoxElement extends HTMLElement {
            constructor() {
                super();
                let shadow = this.attachShadow({mode:'open'});
                shadow.appendChild(doc.getElementById('template-fl-combobox').content.cloneNode(true));
                // slot doesn't work in select
                shadow.children[2].innerHTML += this.innerHTML;
            }
            static get observedAttributes() {
                return ['name', 'label','disabled','required'];
            }
            attributeChangedCallback(attr, oV, nV) {
                if (attr === 'name') {
                    this.shadowRoot.children[2].setAttribute('name', nV);
                    this.shadowRoot.children[2].setAttribute('id', `flcms-${nV}`);
                    this.shadowRoot.children[1].setAttribute('for', `flms-${nV}`);
                }
                if (attr === 'label') {
                    this.shadowRoot.children[1].innerHTML = `${nV}`;
                }
                if (['disabled','required'].includes(attr)) {
                    this.shadowRoot.children[2].setAttribute(attr, '');
                }
            }
            _addOption(v,t) {
                this.shadowRoot.children[2].innerHTML += `<option value="${v}">${t}</option>`
            }
            get value() {
                return this.shadowRoot.children[2].value;
            }
        });
    })();
</script>
